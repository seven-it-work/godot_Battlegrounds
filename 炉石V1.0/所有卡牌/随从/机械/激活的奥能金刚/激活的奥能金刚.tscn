[gd_scene load_steps=2 format=3 uid="uid://b5x464niotexu"]

[ext_resource type="Script" uid="uid://d1rstpchmbfdi" path="res://所有卡牌/随从/BaseMinion.gd" id="1_arcanotron"]

[node name="激活的奥能金刚" type="Node"]
script = ExtResource("1_arcanotron")
race = Array[int]([4])
atk_hp = Vector2i(4, 1)
@export var 嘲讽:bool = true
lushi_id = 115670
str_id = "BG31_173"
"名称" = "激活的奥能金刚"
"描述" = "<b>嘲讽</b>。每当你施放一个酒馆法术时，使一个友方机械获得+3/+2。"
"glod_描述" = "<b>嘲讽</b>。每当你施放一个酒馆法术时，使一个友方机械获得+6/+4。"
"等级" = 3
metadata/_custom_type_script = "uid://d1rstpchmbfdi"

[sub_resource type="GDScript" id="GDScript_1"]
script/source = "extends BaseMinion

@export var 嘲讽:bool = true

func 信号绑定():
	# Assuming a signal like player.施放酒馆法术信号 exists
	# player.施放酒馆法术信号.connect(_on_施放酒馆法术)
	pass

func _on_施放酒馆法术():
	if 卡片所在位置 != Enums.CardPosition.战场:
		return
	var buff_atk: int = 3 * 获取倍率() # +3 for normal, +6 for golden
	var buff_hp: int = 2 * 获取倍率() # +2 for normal, +4 for golden
	var buff_vector: Vector2i = Vector2i(buff_atk, buff_hp)
	var friendly_mechs: Array = player.获取战场上的牌().filter(func(m): return m != self and (Enums.CardRace.机械 in (m as BaseMinion).race))
	if friendly_mechs.is_empty():
		return
	var target_mech = friendly_mechs.pick_random()
	if target_mech:
		var 加成 = AttributeBonus.build(
			'激活的奥能金刚加成',
			buff_vector,
			str(lushi_id)
		)
		(target_mech as BaseMinion).属性加成(加成, true) # Permanent buff
"
