[gd_scene load_steps=2 format=3 uid="uid://cd1wqunc2pqa0"]

[sub_resource type="GDScript" id="GDScript_elegist"]
resource_name = "暗鳞哀歌者"
script/source = "extends BaseMinion

func 信号绑定():
	# 连接回合结束信号
	player.回合结束信号.connect(_on_回合结束)

func _on_回合结束():
	if 卡片所在位置 != Enums.CardPosition.战场:
		return
	
	# 计算加成值(普通卡:+1/+1, 金色卡:+2/+2)
	var 加成值 = 获取倍率()
	
	# 选择战场随从
	var 战场随从 = player.战场.pick_random()
	if 战场随从:
		_应用加成(战场随从, 加成值)
	
	# 选择手牌随从
	var 手牌随从 = player.手牌.pick_random()
	if 手牌随从:
		_应用加成(手牌随从, 加成值)

func _应用加成(目标: BaseMinion, 加成值: int):
	# 创建属性加成
	var 加成 = AttributeBonus.build(
		\"哀歌者祝福\",
		Vector2i(加成值, 加成值),
		str(lushi_id)
	)
	# 应用永久加成
	目标.属性加成(加成,true)
	
	# 更新UI
	if 目标.has_signal(\"属性更新信号\"):
		目标.属性更新信号.emit()
"
metadata/_custom_type_script = "uid://d1rstpchmbfdi"

[node name="暗鳞哀歌者" type="Node"]
script = SubResource("GDScript_elegist")
race = Array[int]([10])
atk_hp = Vector2i(3, 2)
lushi_id = 120679
str_id = "BG32_331"
"名称" = "暗鳞哀歌者"
"描述" = "在你的回合结束时，使一个友方随从和你手牌中的一张随从牌获得+1\\/+1。"
"glod_描述" = "在你的回合结束时，使一个友方随从和你手牌中的一张随从牌获得+2\\/+2。"
"等级" = 2
metadata/_custom_type_script = "uid://d1rstpchmbfdi"
