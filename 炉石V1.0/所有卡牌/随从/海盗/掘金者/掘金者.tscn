[gd_scene load_steps=2 format=3 uid="uid://drqjnyrib8w0e"]

[sub_resource type="GDScript" id="GDScript_goldgrubber"]
resource_name = "掘金者"
script/source = "extends BaseMinion

func 信号绑定():
	# 连接回合结束信号
	player.回合结束信号.connect(_on_回合结束)

func _on_回合结束():
	if 卡片所在位置 != Enums.CardPosition.战场:
		return
	# 计算本回合应获得的总加成：每个金色友方随从 +3/+3（金卡倍率为 +6/+6）
	var 单次加成:int = 3 * 获取倍率()
	var 金色数量:int = 0
	for m in player.获取战场上的牌():
		if (m as BaseMinion).is_gold:
			金色数量 += 1
	if 金色数量 <= 0:
		return
	var 总加成 = Vector2i(单次加成 * 金色数量, 单次加成 * 金色数量)
	var 加成 = AttributeBonus.build(
		'掘金者成长',
		总加成,
		str(lushi_id)
	)
	# 回合结束在非战斗阶段，应用永久加成
	属性加成(加成, true)
"

[node name="掘金者" type="Node"]
script = SubResource("GDScript_goldgrubber")
race = Array[int]([5])
atk_hp = Vector2i(3, 3)
lushi_id = 61066
str_id = "BGS_066"
"名称" = "掘金者"
"描述" = "在你的回合结束时，每有一个金色友方随从，便获得+3/+3。"
"glod_描述" = "在你的回合结束时，每有一个金色友方随从，便获得+6/+6。"
"等级" = 3
metadata/_custom_type_script = "uid://d1rstpchmbfdi"
