[gd_scene load_steps=2 format=3 uid="uid://d2f5h1yyvd8o6"]

[sub_resource type="GDScript" id="GDScript_courier"]
script/source = "extends BaseMinion

@export var 花费金币计数器:int=5

func 信号绑定():
	if !player.花费金币信号.is_connected(_on_花费铸币):
		player.花费金币信号.connect(_on_花费铸币)

func _on_花费铸币(花费数量: int):
	if 卡片所在位置 != Enums.CardPosition.战场:
		return
	花费金币计数器-=花费数量
	# 每当你花掉5枚铸币，使你的海盗获得+2攻击力
	while 花费金币计数器<=0:
		var 友方海盗 = player.获取战场上的牌().filter(func(item): 
			return item is BaseMinion and Enums.CardRace.海盗 in item.race
		)
		
		var 加成值 = Vector2i(2, 0) * 获取倍率()  # 金色版本+4攻击力
		for 海盗 in 友方海盗:
			var 加成 = AttributeBonus.build(名称, 加成值, 名称)
			海盗.属性加成(加成, !player.是否在战斗中())
		花费金币计数器+=5
		print(\"火药运输工：花费 \", 花费数量, \" 枚铸币，使 \", 友方海盗.size(), \" 个海盗获得+\", 加成值.x, \" 攻击力\")
"

[node name="火药运输工" type="Node"]
script = SubResource("GDScript_courier")
race = Array[int]([5])
atk_hp = Vector2i(3, 6)
lushi_id = 98889
str_id = "BG26_810"
"名称" = "火药运输工"
"描述" = "每当你花掉\\n5枚铸币，使你的海盗获得+2攻击力。<i>（还剩5枚！）</i>"
"glod_描述" = "每当你花掉\\n5枚铸币，使你的海盗获得+4攻击力。<i>（还剩5枚！）</i>"
"等级" = 4
"花费" = 4
metadata/_custom_type_script = "uid://d1rstpchmbfdi"
